<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ドキュメント - rpg-core</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container">
                <div class="nav-content">
                    <a href="../index.html" class="logo">rpg-core</a>
                    <ul class="nav-links">
                        <li><a href="../index.html">ホーム</a></li>
                        <li><a href="index.html">ドキュメント</a></li>
                        <li><a href="../examples/index.html">サンプル</a></li>
                        <li><a href="../api/index.html">API</a></li>
                        <li><a href="https://github.com/yonyon-web/rpg-core" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="docs-section">
            <div class="container">
                <div class="docs-layout">
                    <aside class="docs-sidebar">
                        <h3>ドキュメント</h3>
                        <ul>
                            <li><a href="#introduction" class="active">はじめに</a></li>
                            <li><a href="#installation">インストール</a></li>
                            <li><a href="#usage">使い方</a></li>
                            <li><a href="#architecture">アーキテクチャ</a></li>
                            <li><a href="#features">主要機能</a></li>
                            <li><a href="#customization">カスタマイズ</a></li>
                            <li><a href="#development">開発環境</a></li>
                        </ul>
                    </aside>

                    <div class="docs-content">
                        <h1 id="introduction">はじめに</h1>
                        <p>
                            rpg-coreは、JRPG（日本のロールプレイングゲーム）スタイルのターン制RPGを作成するための
                            TypeScriptライブラリです。このライブラリは、数値計算とゲームルールの判定を担当する
                            Core Engineを中心に設計されています。
                        </p>

                        <h2 id="installation">インストール</h2>
                        <p>npmを使用してインストールできます：</p>
                        <pre><code>npm install rpg-core</code></pre>

                        <h2 id="usage">基本的な使い方</h2>
                        
                        <h3>RPGCoreクラスを使用（推奨）</h3>
                        <p>
                            最も簡単な方法は、RPGCoreクラスを使用して、1カ所でライブラリ全体を初期化することです。
                            依存関係は自動的に解決されます。
                        </p>
                        <pre><code>import { RPGCore } from 'rpg-core';

// ライブラリ全体を初期化
const rpg = new RPGCore({
  config: customGameConfig,  // 省略可能（デフォルト設定を使用）
  useEventBus: true          // 省略可能（デフォルト: true）
});

// サービスに簡単にアクセス（依存関係は自動解決）
const battleService = rpg.services.battle;
const itemService = rpg.services.item;

// コントローラーも簡単に作成
const battleController = rpg.controllers.battle();</code></pre>

                        <div class="card">
                            <h3>メリット</h3>
                            <ul>
                                <li>✅ 依存関係が自動的に解決される</li>
                                <li>✅ 1カ所で設定が完結</li>
                                <li>✅ サービス間の接続が自動化</li>
                                <li>✅ 保守性と拡張性が向上</li>
                            </ul>
                        </div>

                        <h3>従来の方法: 個別にインスタンス化</h3>
                        <p>従来の手動インスタンス化も引き続きサポートされています：</p>
                        <pre><code>import { BattleService, ItemService, defaultGameConfig } from 'rpg-core';

const config = defaultGameConfig;
const battleService = new BattleService(config);
const itemService = new ItemService();</code></pre>

                        <h2 id="architecture">アーキテクチャ</h2>
                        <p>rpg-coreは、以下のレイヤー構造を持っています：</p>
                        
                        <div class="card">
                            <h3>レイヤー構造</h3>
                            <ol>
                                <li><strong>UI層</strong> - 見た目と入力の処理</li>
                                <li><strong>Headless UI層</strong> - 選択・確認・キャンセルの操作フロー</li>
                                <li><strong>JRPG Services層</strong> - 操作フローの管理</li>
                                <li><strong>Core Engine層</strong> - 数値計算とルール判定</li>
                                <li><strong>Game State層</strong> - 永続可能な状態</li>
                            </ol>
                        </div>

                        <h3>設計思想</h3>
                        <ul>
                            <li><strong>純粋な計算とルール</strong>: UIや操作フローに依存しない</li>
                            <li><strong>状態を持たない</strong>: Game Stateから必要なデータを受け取り、計算結果を返す</li>
                            <li><strong>決定論的</strong>: 同じ入力に対して常に同じ出力を返す</li>
                            <li><strong>テスト容易</strong>: モックや単体テストが容易に書ける</li>
                        </ul>

                        <h2 id="features">主要機能</h2>
                        <p>rpg-coreは、以下の主要機能を提供します：</p>

                        <h3>🎮 戦闘・操作</h3>
                        <ul>
                            <li><strong>戦闘システム</strong> - 戦闘全体の進行とコマンド選択</li>
                            <li><strong>アイテム使用</strong> - アイテム使用の流れ</li>
                        </ul>

                        <h3>🧠 敵に関する機能</h3>
                        <ul>
                            <li><strong>敵AI</strong> - 敵の行動決定とグループ管理</li>
                        </ul>

                        <h3>📈 成長・キャラクター</h3>
                        <ul>
                            <li><strong>キャラクター成長</strong> - 経験値とレベルアップ</li>
                            <li><strong>スキル習得</strong> - スキル習得の流れ</li>
                            <li><strong>ジョブ変更</strong> - 職業・クラス変更</li>
                            <li><strong>報酬処理</strong> - 戦闘やイベントの報酬処理</li>
                        </ul>

                        <h3>🎒 管理・編成</h3>
                        <ul>
                            <li><strong>インベントリ</strong> - アイテムとバッグの管理</li>
                            <li><strong>装備管理</strong> - 装備の変更管理</li>
                            <li><strong>パーティ編成</strong> - パーティ編成管理</li>
                            <li><strong>状態異常</strong> - 状態異常・バフ・デバフ管理</li>
                        </ul>

                        <h3>🛠 クラフト・育成</h3>
                        <ul>
                            <li><strong>クラフト</strong> - アイテム合成の流れ</li>
                            <li><strong>強化</strong> - 装備やキャラクターの強化</li>
                        </ul>

                        <h3>💾 システム・支援</h3>
                        <ul>
                            <li><strong>セーブ・ロード</strong> - セーブとロードの流れ</li>
                            <li><strong>データ永続化</strong> - ゲーム状態の永続化</li>
                            <li><strong>シミュレーション</strong> - 戦闘や成長のシミュレーション</li>
                        </ul>

                        <h2 id="customization">カスタマイズ</h2>
                        <p>rpg-coreは、ゲーム固有のルールに対応できる拡張性を備えています。</p>

                        <h3>設定のカスタマイズ</h3>
                        <p>ゲーム設定をカスタマイズすることで、独自のゲームバランスを実現できます：</p>
                        <pre><code>import { RPGCore, GameConfig } from 'rpg-core';

const customConfig: GameConfig = {
  maxLevel: 99,
  baseExpCurve: 'exponential',
  damageFormula: 'custom',
  // ... その他の設定
};

const rpg = new RPGCore({ config: customConfig });</code></pre>

                        <h3>Core Engineの拡張</h3>
                        <p>Core Engineを拡張することで、独自の計算ロジックを追加できます。</p>

                        <h2 id="development">開発環境のセットアップ</h2>
                        
                        <h3>必要な環境</h3>
                        <ul>
                            <li>Node.js 18.x以上</li>
                            <li>npm 9.x以上</li>
                        </ul>

                        <h3>依存関係のインストール</h3>
                        <pre><code>npm install</code></pre>

                        <h3>ビルド</h3>
                        <pre><code>npm run build</code></pre>

                        <h3>テスト実行</h3>
                        <pre><code># テストを実行
npm test

# テストをウォッチモードで実行
npm run test:watch

# カバレッジ付きでテスト実行
npm run test:coverage</code></pre>

                        <h3>開発モード</h3>
                        <pre><code># TypeScriptのウォッチモードで開発
npm run watch</code></pre>

                        <h2>次のステップ</h2>
                        <div class="card">
                            <ul>
                                <li><a href="../examples/index.html">サンプルコードを試す</a> - 実際の動作を確認</li>
                                <li><a href="../api/index.html">APIリファレンスを読む</a> - 詳細なAPI仕様</li>
                                <li><a href="https://github.com/yonyon-web/rpg-core" target="_blank" rel="noopener">GitHubリポジトリ</a> - ソースコードとissues</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 rpg-core. Licensed under ISC.</p>
            <p>
                <a href="https://github.com/yonyon-web/rpg-core" target="_blank" rel="noopener">GitHub</a> |
                <a href="https://github.com/yonyon-web/rpg-core/issues" target="_blank" rel="noopener">Issues</a> |
                <a href="index.html">Docs</a>
            </p>
        </div>
    </footer>

    <script>
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    
                    // Update active state
                    document.querySelectorAll('.docs-sidebar a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });

        // Update active link on scroll
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.docs-content h1, .docs-content h2');
            const scrollPosition = window.scrollY + 100;

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionId = section.id;
                
                if (scrollPosition >= sectionTop) {
                    document.querySelectorAll('.docs-sidebar a').forEach(a => a.classList.remove('active'));
                    const activeLink = document.querySelector(`.docs-sidebar a[href="#${sectionId}"]`);
                    if (activeLink) activeLink.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
