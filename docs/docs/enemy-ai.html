<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•µAI - GEasy Kit</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../lib/syntax-highlight.css">
    <script src="../lib/syntax-highlight.js"></script>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container">
                <div class="nav-content">
                    <a href="../index.html" class="logo">GEasy Kit</a>
                    <ul class="nav-links">
                        <li><a href="../index.html">ãƒ›ãƒ¼ãƒ </a></li>
                        <li><a href="index.html">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></li>
                        <li><a href="../customization/index.html">ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</a></li>
                        <li><a href="https://github.com/yonyon-web/GEasy-Kit" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="docs-section">
            <div class="container">
                <div class="docs-layout">
                    <aside class="docs-sidebar">
                        <h3>æ•µAI</h3>
                        <ul>
                            <li><a href="#overview" class="active">æ©Ÿèƒ½ã®æ¦‚è¦</a></li>
                            <li><a href="#headless-ui">Headless UI</a></li>
                            <li><a href="#service">Service</a></li>
                            <li><a href="#core-engine">Core Engine</a></li>
                        </ul>
                        <h4 style="margin-top: 2rem;">é–¢é€£ãƒšãƒ¼ã‚¸</h4>
                        <ul>
                            <li><a href="index.html">â† ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆTOP</a></li>
                            <li><a href="battle.html">æˆ¦é—˜ã‚·ã‚¹ãƒ†ãƒ  â†’</a></li>
                        </ul>
                    </aside>

                    <div class="docs-content">
                        <h1 id="overview">æ•µAI</h1>
                        
                        <h2>æ©Ÿèƒ½ã®æ¦‚è¦</h2>
                        <p>
                            æ•µAIã‚·ã‚¹ãƒ†ãƒ ã¯ã€æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®è¡Œå‹•æ±ºå®šã€ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ã€æˆ¦è¡“ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æä¾›ã—ã¾ã™ã€‚
                            è³¢ã„æ•µã®è¡Œå‹•ã€ã‚°ãƒ«ãƒ¼ãƒ—æˆ¦è¡“ã€é›£æ˜“åº¦èª¿æ•´ãªã©ãŒå¯èƒ½ã§ã™ã€‚
                        </p>

                        <div class="card">
                            <h3>ğŸ¯ ä¸»ãªæ©Ÿèƒ½</h3>
                            <ul>
                                <li><strong>è¡Œå‹•æ±ºå®š</strong>: çŠ¶æ³ã«å¿œã˜ãŸæœ€é©ãªè¡Œå‹•é¸æŠ</li>
                                <li><strong>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠ</strong>: HPã€è„…å¨åº¦ãªã©ã‚’è€ƒæ…®</li>
                                <li><strong>ã‚°ãƒ«ãƒ¼ãƒ—æˆ¦è¡“</strong>: å”åŠ›ã—ãŸè¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³</li>
                                <li><strong>AIé›£æ˜“åº¦</strong>: ç°¡å˜ã‹ã‚‰é«˜é›£åº¦ã¾ã§èª¿æ•´å¯èƒ½</li>
                            </ul>
                        </div>

                        <h2 id="headless-ui">Headless UI</h2>
                        
                        <h3>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
                        <p>EnemyAIControllerã‚’ä½¿ã£ã¦ã€æ•µAIã®å‹•ä½œã‚’ç®¡ç†ã—ã¾ã™ï¼š</p>
                        <pre><code>import { GEasyKit } from 'geasy-kit';

const game = new GEasyKit();
const aiController = game.controllers.enemyAI();

// AIçŠ¶æ…‹ã®è³¼èª­
aiController.subscribe((state) => {
  console.log('AIæ€è€ƒä¸­:', state.thinking);
  updateAIIndicator(state);
});

// æ•µã®è¡Œå‹•ã‚’æ±ºå®š
const action = await aiController.decideAction(enemyId, battleState);

// è¡Œå‹•ã‚’å®Ÿè¡Œ
await aiController.executeAction(enemyId, action);</code></pre>

                        <h3>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•</h3>
                        <p>ã‚¤ãƒ™ãƒ³ãƒˆã‚’è³¼èª­ã—ã¦ã€ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã‚’è¿½åŠ ã§ãã¾ã™ï¼š</p>
                        <pre><code>// è¡Œå‹•æ±ºå®šæ™‚ã®å‡¦ç†
aiController.on('actionDecided', (event) => {
  console.log(\`\${event.enemy.name}ã®è¡Œå‹•: \${event.action.type}\`);
  showEnemyThought(event.enemy, event.action);
});

// ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠæ™‚ã®å‡¦ç†
aiController.on('targetSelected', (event) => {
  showTargetIndicator(event.target);
});</code></pre>

                        <h3>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹</h3>
                        <div class="card">
                            <h4>EnemyAIController</h4>
                            <pre><code>interface EnemyAIController {
  // çŠ¶æ…‹ç®¡ç†
  getState(): EnemyAIState;
  subscribe(listener: (state: EnemyAIState) => void): () => void;
  
  // AIåˆ¶å¾¡
  decideAction(enemyId: string, context: BattleContext): Promise<Action>;
  executeAction(enemyId: string, action: Action): Promise<void>;
  setAIDifficulty(difficulty: 'easy' | 'normal' | 'hard'): void;
  
  // ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­
  on(event: string, handler: (data: any) => void): () => void;
}</code></pre>
                        </div>

                        <h2 id="service">Service</h2>
                        
                        <h3>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
                        <p>EnemyAIServiceã¯æ•µã®è¡Œå‹•ç®¡ç†ã‚’è¡Œã„ã¾ã™ï¼š</p>
                        <pre><code>const aiService = game.services.enemyAI;

// æ•µã®è¡Œå‹•ã‚’æ±ºå®š
const action = await aiService.decideAction(enemyId, {
  party: playerParty,
  enemies: enemyGroup,
  turnNumber: 5
});

console.log('è¡Œå‹•ã‚¿ã‚¤ãƒ—:', action.type);
console.log('ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ:', action.targetId);

// ã‚°ãƒ«ãƒ¼ãƒ—æˆ¦è¡“ã‚’å®Ÿè¡Œ
const groupActions = await aiService.decideGroupActions(enemyGroup, context);

// AIé›£æ˜“åº¦ã‚’è¨­å®š
aiService.setDifficulty('hard');</code></pre>

                        <h3>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•</h3>
                        <p>EnemyAIServiceã‚’æ‹¡å¼µã—ã¦ã€ç‹¬è‡ªã®AIãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ ã§ãã¾ã™ï¼š</p>
                        <pre><code>import { EnemyAIService } from 'geasy-kit';

class CustomEnemyAIService extends EnemyAIService {
  // ã‚«ã‚¹ã‚¿ãƒ AIãƒ­ã‚¸ãƒƒã‚¯
  async decideAction(enemyId, context) {
    const enemy = this.getEnemy(enemyId);
    const party = context.party;
    
    // HPãŒä½ã„å‘³æ–¹ãŒã„ã‚‹å ´åˆã¯å›å¾©ã‚’å„ªå…ˆ
    if (enemy.canHeal) {
      const lowHpAlly = this.findLowHpAlly(context.enemies);
      if (lowHpAlly && lowHpAlly.hp < lowHpAlly.maxHp * 0.3) {
        return {
          type: 'heal',
          targetId: lowHpAlly.id
        };
      }
    }
    
    // HPãŒä½ã„æ•µã‚’ç‹™ã†æˆ¦è¡“
    const weakestTarget = this.findWeakestTarget(party);
    return {
      type: 'attack',
      targetId: weakestTarget.id
    };
  }
}</code></pre>

                        <h3>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹</h3>
                        <div class="card">
                            <h4>EnemyAIService</h4>
                            <pre><code>class EnemyAIService {
  // è¡Œå‹•æ±ºå®š
  decideAction(enemyId: string, context: BattleContext): Promise<Action>;
  decideGroupActions(enemies: Enemy[], context: BattleContext): Promise<Action[]>;
  
  // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠ
  selectTarget(enemy: Enemy, party: Character[]): string;
  
  // é›£æ˜“åº¦è¨­å®š
  setDifficulty(difficulty: 'easy' | 'normal' | 'hard'): void;
  
  // æˆ¦è¡“è©•ä¾¡
  evaluateAction(action: Action, context: BattleContext): number;
  
  // ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
  emit(event: string, data: any): void;
}</code></pre>
                        </div>

                        <h2 id="core-engine">Core Engine</h2>
                        
                        <h3>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
                        <p>Core Engineã¯AIã®è©•ä¾¡è¨ˆç®—ã‚’è¡Œã„ã¾ã™ï¼š</p>
                        <pre><code>const engine = game.engine;

// ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè©•ä¾¡
const targetScore = engine.evaluateTarget(enemy, target);

// è¡Œå‹•è©•ä¾¡
const actionScore = engine.evaluateAction(action, context);

// è„…å¨åº¦è¨ˆç®—
const threat = engine.calculateThreat(character, context);</code></pre>

                        <h3>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•</h3>
                        <p>AIè©•ä¾¡ã®è¨ˆç®—å¼ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ï¼š</p>
                        <pre><code>import { AIEvaluator } from 'geasy-kit';

class CustomAIEvaluator extends AIEvaluator {
  // ã‚«ã‚¹ã‚¿ãƒ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè©•ä¾¡
  evaluateTarget(attacker, target) {
    let score = 0;
    
    // HPãŒä½ã„æ•µã‚’å„ªå…ˆï¼ˆé‡ã¿å¢—åŠ ï¼‰
    const hpRatio = target.currentHp / target.maxHp;
    score += (1 - hpRatio) * 200;  // æ¨™æº–ã¯100
    
    // å›å¾©å½¹ã‚’å„ªå…ˆ
    if (target.role === 'healer') {
      score += 150;
    }
    
    // æ”»æ’ƒåŠ›ãŒé«˜ã„æ•µã‚’å„ªå…ˆ
    score += target.attack * 0.8;
    
    return score;
  }
  
  // ã‚«ã‚¹ã‚¿ãƒ è¡Œå‹•è©•ä¾¡
  evaluateAction(action, context) {
    let score = super.evaluateAction(action, context);
    
    // ãƒœã‚¹æˆ¦ã§ã¯é˜²å¾¡çš„ãªè¡Œå‹•ã‚’è©•ä¾¡
    if (context.isBossBattle && action.type === 'defend') {
      score *= 1.5;
    }
    
    return score;
  }
}

const game = new GEasyKit({
  config: {
    aiEvaluator: new CustomAIEvaluator()
  }
});</code></pre>

                        <h3>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹</h3>
                        <div class="card">
                            <h4>Core Engine - AIé–¢é€£</h4>
                            <pre><code>interface AICoreEngine {
  // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè©•ä¾¡
  evaluateTarget(
    attacker: Enemy,
    target: Character
  ): number;
  
  // è¡Œå‹•è©•ä¾¡
  evaluateAction(
    action: Action,
    context: BattleContext
  ): number;
  
  // è„…å¨åº¦è¨ˆç®—
  calculateThreat(
    character: Character,
    context: BattleContext
  ): number;
  
  // æœ€é©è¡Œå‹•é¸æŠ
  selectBestAction(
    enemy: Enemy,
    availableActions: Action[],
    context: BattleContext
  ): Action;
}</code></pre>
                        </div>

                        <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>
                        <div class="card">
                            <ul>
                                <li><a href="battle.html">æˆ¦é—˜ã‚·ã‚¹ãƒ†ãƒ </a> - æ•µAIã¨æˆ¦é—˜ã®é€£æº</li>
                                <li><a href="status-effects.html">çŠ¶æ…‹ç•°å¸¸</a> - AIã®çŠ¶æ…‹ç•°å¸¸æ´»ç”¨</li>
                                <li><a href="../customization/index.html">ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚¬ã‚¤ãƒ‰</a> - æ•µAIã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 GEasy Kit. Licensed under ISC.</p>
            <p>
                <a href="https://github.com/yonyon-web/GEasy-Kit" target="_blank" rel="noopener">GitHub</a> |
                <a href="https://github.com/yonyon-web/GEasy-Kit/issues" target="_blank" rel="noopener">Issues</a> |
                <a href="index.html">Docs</a>
            </p>
        </div>
    </footer>

    <script>
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    document.querySelectorAll('.docs-sidebar a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
