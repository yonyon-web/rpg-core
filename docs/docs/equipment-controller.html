<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è£…å‚™è„±ç€(EquipmentController) - GEasy Kit</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../lib/syntax-highlight.css">
    <script src="../lib/syntax-highlight.js"></script>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container">
                <div class="nav-content">
                    <a href="../index.html" class="logo">GEasy Kit</a>
                    <ul class="nav-links">
                        <li><a href="../index.html">ãƒ›ãƒ¼ãƒ </a></li>
                        <li><a href="index.html">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></li>
                        <li><a href="../customization/index.html">ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</a></li>
                        <li><a href="https://github.com/yonyon-web/GEasy-Kit" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="docs-section">
            <div class="container">
                <div class="docs-layout">
                    <aside class="docs-sidebar">
                        <h3>è£…å‚™è„±ç€</h3>
                        <ul>
                            <li><a href="#overview" class="active">æ©Ÿèƒ½ã®æ¦‚è¦</a></li>
                            <li><a href="#headless-ui">Headless UI</a></li>
                            <li><a href="#service">Service</a></li>
                            <li><a href="#core-engine">Core Engine</a></li>
                        </ul>
                        <h4 style="margin-top: 2rem;">é–¢é€£ãƒšãƒ¼ã‚¸</h4>
                        <ul>
                            <li><a href="inventory-controller.html">â† ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªç®¡ç†</a></li>
                            <li><a href="item.html">ã‚¢ã‚¤ãƒ†ãƒ TOP â†’</a></li>
                        </ul>
                    </aside>

                    <div class="docs-content">
                        <h1 id="overview">è£…å‚™è„±ç€(EquipmentController)</h1>
                        
                        <h2>æ©Ÿèƒ½ã®æ¦‚è¦</h2>
                        <p>
                            EquipmentControllerã¯ã€æ­¦å™¨ãƒ»é˜²å…·ã®è£…å‚™å¤‰æ›´ã‚’ç®¡ç†ã—ã¾ã™ã€‚
                            è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆã®é¸æŠã€è£…å‚™å¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ ã®è¡¨ç¤ºã€è£…å‚™å¤‰æ›´æ™‚ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰åŒ–ã‚’æä¾›ã—ã¾ã™ã€‚
                        </p>

                        <div class="card">
                            <h3>ğŸ¯ ä¸»ãªæ©Ÿèƒ½</h3>
                            <ul>
                                <li><strong>è£…å‚™ã‚·ã‚¹ãƒ†ãƒ </strong>: æ­¦å™¨ãƒ»é˜²å…·ã®è£…å‚™å¤‰æ›´</li>
                                <li><strong>è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆç®¡ç†</strong>: æ­¦å™¨ã€é ­ã€ä½“ã€ã‚¢ã‚¯ã‚»ã‚µãƒªãªã©</li>
                                <li><strong>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¨ˆç®—</strong>: è£…å‚™ã«ã‚ˆã‚‹èƒ½åŠ›å€¤å¤‰åŒ–</li>
                                <li><strong>è£…å‚™åˆ¶é™</strong>: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚„ã‚¸ãƒ§ãƒ–ã«ã‚ˆã‚‹è£…å‚™å¯å¦åˆ¤å®š</li>
                            </ul>
                        </div>

                        <h2 id="headless-ui">Headless UI</h2>
                        
                        <h3>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
                        <p>EquipmentControllerã‚’ä½¿ã†åŸºæœ¬çš„ãªä¾‹ã§ã™ï¼š</p>
                        <pre><code>import { GEasyKit } from 'geasy-kit';

const game = new GEasyKit();

// è£…å‚™å¤‰æ›´
const equipmentController = game.controllers.equipment();

equipmentController.on('equipment-changed', (data) => {
  console.log('è£…å‚™å¤‰æ›´:', data.slot, data.newEquipment);
  updateCharacterStats(data.statChanges);
});

equipmentController.on('slot-selected', (data) => {
  console.log('ã‚¹ãƒ­ãƒƒãƒˆé¸æŠ:', data.slot);
  showEquipableItems(data.slot);
});

equipmentController.on('equipment-unequipped', (data) => {
  console.log('è£…å‚™ã‚’å¤–ã—ãŸ:', data.slot, data.equipment);
});</code></pre>

                        <h3>ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§</h3>
                        <p><code>on()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã§è³¼èª­ã§ãã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ï¼š</p>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>ã‚¤ãƒ™ãƒ³ãƒˆå</th>
                                    <th>ãƒ‡ãƒ¼ã‚¿</th>
                                    <th>èª¬æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>stage-changed</td>
                                    <td>{ stage }</td>
                                    <td>ã‚¹ãƒ†ãƒ¼ã‚¸ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ã</td>
                                </tr>
                                <tr>
                                    <td>slot-selected</td>
                                    <td>{ slot }</td>
                                    <td>è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆãŒé¸æŠã•ã‚ŒãŸã¨ã</td>
                                </tr>
                                <tr>
                                    <td>equipment-selected</td>
                                    <td>{ equipment }</td>
                                    <td>è£…å‚™ãŒé¸æŠã•ã‚ŒãŸã¨ã</td>
                                </tr>
                                <tr>
                                    <td>equipment-changed</td>
                                    <td>{ slot, oldEquipment, newEquipment, statChanges }</td>
                                    <td>è£…å‚™ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ã</td>
                                </tr>
                                <tr>
                                    <td>equipment-unequipped</td>
                                    <td>{ slot, equipment }</td>
                                    <td>è£…å‚™ãŒå¤–ã•ã‚ŒãŸã¨ã</td>
                                </tr>
                            </tbody>
                        </table>

                        <h3>è£…å‚™å¤‰æ›´ãƒ•ãƒ­ãƒ¼</h3>
                        <p>EquipmentControllerã¯ä»¥ä¸‹ã®æµã‚Œã§è£…å‚™å¤‰æ›´ã‚’é€²è¡Œã—ã¾ã™ï¼š</p>
                        <div class="flow-diagram">
                            <div class="flow-step">
                                <div class="flow-node flow-start">è£…å‚™å¤‰æ›´é–‹å§‹</div>
                                <div class="flow-arrow">â†“</div>
                            </div>
                            <div class="flow-step">
                                <div class="flow-node">ã‚¹ãƒ­ãƒƒãƒˆé¸æŠ<br/><code>selectSlot()</code></div>
                                <div class="flow-arrow">â†“</div>
                            </div>
                            <div class="flow-step">
                                <div class="flow-node">è£…å‚™å“é¸æŠ<br/><code>selectEquipment()</code></div>
                                <div class="flow-arrow">â†“</div>
                            </div>
                            <div class="flow-step">
                                <div class="flow-node flow-decision">è£…å‚™å¯èƒ½åˆ¤å®š</div>
                                <div class="flow-branch">
                                    <div class="flow-arrow-branch">
                                        <span class="branch-label">å¯èƒ½</span>
                                        <div class="arrow-down">â†“</div>
                                    </div>
                                    <div class="flow-arrow-branch">
                                        <span class="branch-label">ä¸å¯</span>
                                        <div class="arrow-down">â†’ã‚¨ãƒ©ãƒ¼</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flow-step">
                                <div class="flow-node">è£…å‚™å®Ÿè¡Œ<br/><code>equipItem()</code></div>
                                <div class="flow-arrow">â†“</div>
                            </div>
                            <div class="flow-step">
                                <div class="flow-node">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°</div>
                                <div class="flow-arrow">â†“</div>
                            </div>
                            <div class="flow-step">
                                <div class="flow-node flow-end">è£…å‚™å®Œäº†</div>
                            </div>
                        </div>

                        <h3>ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡ã®é–¢æ•°</h3>
                        <p>è£…å‚™å¤‰æ›´ã®æµã‚Œã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã®é–¢æ•°ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š</p>
                        <ul>
                            <li><code>selectSlot(slot)</code> - è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆã‚’é¸æŠ</li>
                            <li><code>selectEquipment(equipmentId)</code> - è£…å‚™å“ã‚’é¸æŠ</li>
                            <li><code>equipItem(slot, equipmentId)</code> - è£…å‚™ã‚’å®Ÿè¡Œ</li>
                            <li><code>unequipItem(slot)</code> - è£…å‚™ã‚’å¤–ã™</li>
                            <li><code>canEquip(characterId, equipmentId)</code> - è£…å‚™å¯èƒ½ã‹åˆ¤å®š</li>
                        </ul>

                        <h3>ã‚¹ãƒ†ãƒ¼ãƒˆæ§‹é€ </h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
                                    <th>å‹</th>
                                    <th>èª¬æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>stage</td>
                                    <td>string</td>
                                    <td>ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¸ï¼ˆ'idle' | 'selecting_slot' | 'selecting_equipment'ï¼‰</td>
                                </tr>
                                <tr>
                                    <td>selectedSlot</td>
                                    <td>string | null</td>
                                    <td>é¸æŠä¸­ã®è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆ</td>
                                </tr>
                                <tr>
                                    <td>selectedEquipment</td>
                                    <td>Equipment | null</td>
                                    <td>é¸æŠä¸­ã®è£…å‚™å“</td>
                                </tr>
                                <tr>
                                    <td>equippedItems</td>
                                    <td>Record&lt;string, Equipment&gt;</td>
                                    <td>ç¾åœ¨ã®è£…å‚™çŠ¶æ³ï¼ˆã‚¹ãƒ­ãƒƒãƒˆå â†’ è£…å‚™å“ï¼‰</td>
                                </tr>
                                <tr>
                                    <td>availableEquipment</td>
                                    <td>Equipment[]</td>
                                    <td>è£…å‚™å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§</td>
                                </tr>
                                <tr>
                                    <td>statPreview</td>
                                    <td>StatChanges | null</td>
                                    <td>è£…å‚™å¤‰æ›´æ™‚ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰åŒ–ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</td>
                                </tr>
                            </tbody>
                        </table>

                        <h3>ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
                                    <th>å¼•æ•°</th>
                                    <th>æˆ»ã‚Šå€¤</th>
                                    <th>èª¬æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>selectSlot</td>
                                    <td>slot: string</td>
                                    <td>Promise&lt;void&gt;</td>
                                    <td>è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆã‚’é¸æŠã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>selectEquipment</td>
                                    <td>equipmentId: string</td>
                                    <td>Promise&lt;void&gt;</td>
                                    <td>è£…å‚™å“ã‚’é¸æŠã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>equipItem</td>
                                    <td>slot: string, equipmentId: string</td>
                                    <td>Promise&lt;EquipResult&gt;</td>
                                    <td>è£…å‚™ã‚’å®Ÿè¡Œã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>unequipItem</td>
                                    <td>slot: string</td>
                                    <td>Promise&lt;void&gt;</td>
                                    <td>è£…å‚™ã‚’å¤–ã™</td>
                                </tr>
                                <tr>
                                    <td>previewStats</td>
                                    <td>slot: string, equipmentId: string</td>
                                    <td>StatChanges</td>
                                    <td>è£…å‚™å¤‰æ›´æ™‚ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰åŒ–ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>getState</td>
                                    <td>-</td>
                                    <td>EquipmentState</td>
                                    <td>ç¾åœ¨ã®çŠ¶æ…‹ã‚’å–å¾—ã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>subscribe</td>
                                    <td>listener: (state: EquipmentState) =&gt; void</td>
                                    <td>() =&gt; void</td>
                                    <td>çŠ¶æ…‹å¤‰æ›´ã‚’è³¼èª­ã™ã‚‹ï¼ˆè§£é™¤é–¢æ•°ã‚’è¿”ã™ï¼‰</td>
                                </tr>
                                <tr>
                                    <td>on</td>
                                    <td>event: string, handler: (data: any) =&gt; void</td>
                                    <td>() =&gt; void</td>
                                    <td>ã‚¤ãƒ™ãƒ³ãƒˆã‚’è³¼èª­ã™ã‚‹ï¼ˆè§£é™¤é–¢æ•°ã‚’è¿”ã™ï¼‰</td>
                                </tr>
                            </tbody>
                        </table>

                        <h2 id="service">Service</h2>
                        
                        <h3>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
                        <p>EquipmentServiceã¯è£…å‚™ç®¡ç†ã‚’è¡Œã„ã¾ã™ï¼š</p>
                        <pre><code>const equipmentService = game.services.equipment;

// è£…å‚™å¤‰æ›´
await equipmentService.equipItem(characterId, slot, equipmentId);

// è£…å‚™ã‚’å¤–ã™
await equipmentService.unequipItem(characterId, slot);

// è£…å‚™çŠ¶æ³ã‚’å–å¾—
const equipped = equipmentService.getEquippedItems(characterId);
console.log('æ­¦å™¨:', equipped.weapon);
console.log('é˜²å…·:', equipped.armor);

// è£…å‚™å¯èƒ½åˆ¤å®š
const canEquip = equipmentService.canEquip(characterId, equipmentId);
if (!canEquip) {
  console.log('ã“ã®è£…å‚™ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“');
}</code></pre>

                        <h3>ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
                                    <th>å¼•æ•°</th>
                                    <th>æˆ»ã‚Šå€¤</th>
                                    <th>èª¬æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>equipItem</td>
                                    <td>characterId: string, slot: string, equipmentId: string</td>
                                    <td>Promise&lt;EquipResult&gt;</td>
                                    <td>è£…å‚™ã‚’å®Ÿè¡Œã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>unequipItem</td>
                                    <td>characterId: string, slot: string</td>
                                    <td>Promise&lt;void&gt;</td>
                                    <td>è£…å‚™ã‚’å¤–ã™</td>
                                </tr>
                                <tr>
                                    <td>getEquippedItems</td>
                                    <td>characterId: string</td>
                                    <td>Record&lt;string, Equipment&gt;</td>
                                    <td>è£…å‚™çŠ¶æ³ã‚’å–å¾—ã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>canEquip</td>
                                    <td>characterId: string, equipmentId: string</td>
                                    <td>boolean</td>
                                    <td>è£…å‚™å¯èƒ½ã‹åˆ¤å®šã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>getEquipableItems</td>
                                    <td>characterId: string, slot: string</td>
                                    <td>Equipment[]</td>
                                    <td>æŒ‡å®šã‚¹ãƒ­ãƒƒãƒˆã«è£…å‚™å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã‚’å–å¾—ã™ã‚‹</td>
                                </tr>
                            </tbody>
                        </table>

                        <h2 id="core-engine">Core Engine</h2>
                        
                        <h3>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
                        <p>Core Engineã¯è£…å‚™ã«ã‚ˆã‚‹èƒ½åŠ›è¨ˆç®—ã‚’è¡Œã„ã¾ã™ï¼š</p>
                        <pre><code>const engine = game.engine;

// è£…å‚™ã«ã‚ˆã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰åŒ–
const statChanges = engine.calculateEquipmentStats(character, equipment);
console.log('æ”»æ’ƒåŠ›:', statChanges.attack);
console.log('é˜²å¾¡åŠ›:', statChanges.defense);

// è£…å‚™å¯èƒ½åˆ¤å®š
const canEquip = engine.checkEquipable(character, equipment);

// è£…å‚™ãƒœãƒ¼ãƒŠã‚¹è¨ˆç®—
const bonus = engine.calculateSetBonus(equippedItems);</code></pre>

                        <h3>ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
                                    <th>å¼•æ•°</th>
                                    <th>æˆ»ã‚Šå€¤</th>
                                    <th>èª¬æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>calculateEquipmentStats</td>
                                    <td>character: Character, equipment: Equipment</td>
                                    <td>StatChanges</td>
                                    <td>è£…å‚™ã«ã‚ˆã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰åŒ–ã‚’è¨ˆç®—ã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>checkEquipable</td>
                                    <td>character: Character, equipment: Equipment</td>
                                    <td>boolean</td>
                                    <td>è£…å‚™å¯èƒ½ã‹åˆ¤å®šã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>calculateSetBonus</td>
                                    <td>equippedItems: Equipment[]</td>
                                    <td>StatBonus</td>
                                    <td>è£…å‚™ã‚»ãƒƒãƒˆãƒœãƒ¼ãƒŠã‚¹ã‚’è¨ˆç®—ã™ã‚‹</td>
                                </tr>
                                <tr>
                                    <td>getTotalStats</td>
                                    <td>character: Character, equippedItems: Record&lt;string, Equipment&gt;</td>
                                    <td>Stats</td>
                                    <td>è£…å‚™è¾¼ã¿ã®ç·åˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å–å¾—ã™ã‚‹</td>
                                </tr>
                            </tbody>
                        </table>

                        <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>
                        <div class="card">
                            <ul>
                                <li><a href="item-controller.html">ã‚¢ã‚¤ãƒ†ãƒ </a> - ã‚¢ã‚¤ãƒ†ãƒ ä½¿ç”¨ãƒ•ãƒ­ãƒ¼</li>
                                <li><a href="inventory-controller.html">ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªç®¡ç†</a> - ã‚¢ã‚¤ãƒ†ãƒ ã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»æ•´ç†</li>
                                <li><a href="character-growth.html">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æˆé•·</a> - èƒ½åŠ›å€¤ã®æˆé•·</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 GEasy Kit. Licensed under ISC.</p>
            <p>
                <a href="https://github.com/yonyon-web/GEasy-Kit" target="_blank" rel="noopener">GitHub</a> |
                <a href="https://github.com/yonyon-web/GEasy-Kit/issues" target="_blank" rel="noopener">Issues</a> |
                <a href="index.html">Docs</a>
            </p>
        </div>
    </footer>

    <script>
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    document.querySelectorAll('.docs-sidebar a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
