<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIリファレンス - GEasy-Kit</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container">
                <div class="nav-content">
                    <a href="../index.html" class="logo">GEasy-Kit</a>
                    <ul class="nav-links">
                        <li><a href="../index.html">ホーム</a></li>
                        <li><a href="../docs/index.html">ドキュメント</a></li>
                        <li><a href="../examples/index.html">サンプル</a></li>
                        <li><a href="index.html">API</a></li>
                        <li><a href="https://github.com/yonyon-web/GEasy-Kit" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="api-section">
            <div class="container">
                <div class="docs-layout">
                    <aside class="docs-sidebar">
                        <h3>API</h3>
                        <ul>
                            <li><a href="#rpgcore" class="active">RPGCore</a></li>
                            <li><a href="#services">Services</a></li>
                            <li><a href="#controllers">Controllers</a></li>
                            <li><a href="#types">Types</a></li>
                            <li><a href="#config">Configuration</a></li>
                            <li><a href="#eventbus">EventBus</a></li>
                        </ul>
                    </aside>

                    <div class="docs-content">
                        <h1>APIリファレンス</h1>
                        <p>GEasy-Kitライブラリの主要なクラス、インターフェース、型定義のリファレンスです。</p>

                        <h2 id="rpgcore">RPGCore</h2>
                        <p>ライブラリのメインエントリーポイント。すべてのサービスとコントローラーへのアクセスを提供します。</p>

                        <div class="card">
                            <h3>コンストラクタ</h3>
                            <pre><code>new RPGCore(options?: RPGCoreOptions)</code></pre>
                            
                            <h4>パラメータ</h4>
                            <ul>
                                <li><code>options.config</code> (optional): ゲーム設定オブジェクト</li>
                                <li><code>options.useEventBus</code> (optional, default: true): EventBusの使用有無</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>プロパティ</h3>
                            <ul>
                                <li><code>services</code>: すべてのサービスへのアクセス</li>
                                <li><code>controllers</code>: コントローラーファクトリーへのアクセス</li>
                                <li><code>eventBus</code>: イベントバスインスタンス（useEventBus: trueの場合）</li>
                                <li><code>config</code>: ゲーム設定オブジェクト</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>使用例</h3>
                            <pre><code>const rpg = new RPGCore({
  config: customConfig,
  useEventBus: true
});

const battleService = rpg.services.battle;
const battleController = rpg.controllers.battle();</code></pre>
                        </div>

                        <h2 id="services">Services</h2>
                        <p>ゲームロジックを提供するサービス群です。</p>

                        <h3>BattleService</h3>
                        <div class="card">
                            <p>戦闘システムを管理するサービス</p>
                            <h4>主要メソッド</h4>
                            <ul>
                                <li><code>startBattle(params: BattleParams): BattleState</code></li>
                                <li><code>executeCommand(state: BattleState, command: BattleCommand): BattleResult</code></li>
                                <li><code>processTurn(state: BattleState): TurnResult</code></li>
                                <li><code>isBattleOver(state: BattleState): boolean</code></li>
                            </ul>
                        </div>

                        <h3>ItemService</h3>
                        <div class="card">
                            <p>アイテムの使用と効果を管理するサービス</p>
                            <h4>主要メソッド</h4>
                            <ul>
                                <li><code>useItem(itemId: string, target: Character): UseItemResult</code></li>
                                <li><code>canUseItem(itemId: string, target: Character): boolean</code></li>
                                <li><code>getItemEffect(itemId: string): ItemEffect</code></li>
                            </ul>
                        </div>

                        <h3>InventoryService</h3>
                        <div class="card">
                            <p>インベントリを管理するサービス</p>
                            <h4>主要メソッド</h4>
                            <ul>
                                <li><code>addItem(itemId: string, quantity: number): boolean</code></li>
                                <li><code>removeItem(itemId: string, quantity: number): boolean</code></li>
                                <li><code>getItems(): Item[]</code></li>
                                <li><code>hasItem(itemId: string, quantity: number): boolean</code></li>
                            </ul>
                        </div>

                        <h3>EquipmentService</h3>
                        <div class="card">
                            <p>装備の変更と管理を行うサービス</p>
                            <h4>主要メソッド</h4>
                            <ul>
                                <li><code>equipItem(character: Character, item: Equipment, slot: EquipmentSlot): EquipResult</code></li>
                                <li><code>unequipItem(character: Character, slot: EquipmentSlot): Equipment | null</code></li>
                                <li><code>canEquip(character: Character, item: Equipment): boolean</code></li>
                                <li><code>calculateStats(character: Character): Stats</code></li>
                            </ul>
                        </div>

                        <h3>GrowthService</h3>
                        <div class="card">
                            <p>キャラクターの成長とレベルアップを管理するサービス</p>
                            <h4>主要メソッド</h4>
                            <ul>
                                <li><code>gainExperience(character: Character, exp: number): GrowthResult</code></li>
                                <li><code>levelUp(character: Character): LevelUpResult</code></li>
                                <li><code>getRequiredExp(level: number): number</code></li>
                                <li><code>calculateStatGrowth(character: Character): Stats</code></li>
                            </ul>
                        </div>

                        <h3>PartyService</h3>
                        <div class="card">
                            <p>パーティ編成を管理するサービス</p>
                            <h4>主要メソッド</h4>
                            <ul>
                                <li><code>createParty(params: PartyParams): Party</code></li>
                                <li><code>addMember(party: Party, character: Character): boolean</code></li>
                                <li><code>removeMember(party: Party, characterId: string): boolean</code></li>
                                <li><code>reorderMembers(party: Party, order: string[]): void</code></li>
                            </ul>
                        </div>

                        <h3>SkillService</h3>
                        <div class="card">
                            <p>スキルの習得と使用を管理するサービス</p>
                            <h4>主要メソッド</h4>
                            <ul>
                                <li><code>learnSkill(character: Character, skillId: string): LearnResult</code></li>
                                <li><code>getLearnableSkills(character: Character): Skill[]</code></li>
                                <li><code>canUseSkill(character: Character, skill: Skill): boolean</code></li>
                            </ul>
                        </div>

                        <h3>StatusService</h3>
                        <div class="card">
                            <p>状態異常とバフ・デバフを管理するサービス</p>
                            <h4>主要メソッド</h4>
                            <ul>
                                <li><code>applyStatus(character: Character, status: StatusEffect): void</code></li>
                                <li><code>removeStatus(character: Character, statusId: string): void</code></li>
                                <li><code>processTurn(character: Character): StatusTurnResult</code></li>
                                <li><code>getActiveStatuses(character: Character): StatusEffect[]</code></li>
                            </ul>
                        </div>

                        <h2 id="controllers">Controllers</h2>
                        <p>UIとサービスの間を仲介するコントローラー群です。</p>

                        <div class="card">
                            <h3>BattleController</h3>
                            <p>戦闘フローを管理し、UIとBattleServiceを接続します。</p>
                            <pre><code>const battleController = rpg.controllers.battle();

// 戦闘開始
battleController.start(playerParty, enemyParty);

// コマンド選択
const availableCommands = battleController.getAvailableCommands();

// コマンド実行
battleController.executeCommand(selectedCommand);</code></pre>
                        </div>

                        <h2 id="types">主要な型定義</h2>

                        <h3>Character</h3>
                        <div class="card">
                            <pre><code>interface Character {
  id: string;
  name: string;
  level: number;
  exp: number;
  hp: number;
  maxHp: number;
  mp: number;
  maxMp: number;
  stats: Stats;
  equipment: Equipment[];
  skills: Skill[];
  statusEffects: StatusEffect[];
}</code></pre>
                        </div>

                        <h3>Stats</h3>
                        <div class="card">
                            <pre><code>interface Stats {
  attack: number;
  defense: number;
  magicAttack: number;
  magicDefense: number;
  speed: number;
  luck: number;
}</code></pre>
                        </div>

                        <h3>BattleCommand</h3>
                        <div class="card">
                            <pre><code>interface BattleCommand {
  type: 'attack' | 'skill' | 'item' | 'defend' | 'escape';
  actorId: string;
  targetId?: string;
  skillId?: string;
  itemId?: string;
}</code></pre>
                        </div>

                        <h3>Item</h3>
                        <div class="card">
                            <pre><code>interface Item {
  id: string;
  name: string;
  type: 'consumable' | 'equipment' | 'keyItem';
  description: string;
  effect?: ItemEffect;
  value: number;
}</code></pre>
                        </div>

                        <h2 id="config">Configuration</h2>
                        <p>ゲームの設定をカスタマイズするためのオプションです。</p>

                        <div class="card">
                            <h3>GameConfig</h3>
                            <pre><code>interface GameConfig {
  // レベルシステム
  maxLevel: number;
  baseExpCurve: 'linear' | 'exponential' | 'logarithmic';
  
  // 戦闘システム
  damageFormula: 'standard' | 'custom';
  criticalHitChance: number;
  criticalHitMultiplier: number;
  
  // パーティ
  maxPartySize: number;
  
  // インベントリ
  maxInventorySize: number;
  
  // その他
  enableAutoSave: boolean;
  saveSlots: number;
}</code></pre>
                        </div>

                        <div class="card">
                            <h3>デフォルト設定</h3>
                            <pre><code>import { defaultGameConfig } from 'GEasy-Kit';

const config = {
  ...defaultGameConfig,
  maxLevel: 99,  // カスタマイズしたい項目のみ上書き
  maxPartySize: 5
};</code></pre>
                        </div>

                        <h2 id="eventbus">EventBus</h2>
                        <p>イベント駆動の処理を実現するEventBusです。</p>

                        <div class="card">
                            <h3>主要メソッド</h3>
                            <ul>
                                <li><code>on(event: string, handler: Function): void</code> - イベントリスナーを登録</li>
                                <li><code>off(event: string, handler: Function): void</code> - イベントリスナーを解除</li>
                                <li><code>emit(event: string, data: any): void</code> - イベントを発行</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>利用可能なイベント</h3>
                            <ul>
                                <li><code>battle:start</code> - 戦闘開始</li>
                                <li><code>battle:end</code> - 戦闘終了</li>
                                <li><code>battle:turn</code> - ターン開始</li>
                                <li><code>character:damage</code> - ダメージを受けた</li>
                                <li><code>character:heal</code> - 回復した</li>
                                <li><code>character:levelUp</code> - レベルアップ</li>
                                <li><code>character:death</code> - 戦闘不能</li>
                                <li><code>item:used</code> - アイテム使用</li>
                                <li><code>skill:used</code> - スキル使用</li>
                                <li><code>status:applied</code> - 状態異常付与</li>
                                <li><code>status:removed</code> - 状態異常解除</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h3>使用例</h3>
                            <pre><code>const rpg = new RPGCore({ useEventBus: true });
const eventBus = rpg.eventBus;

// イベントリスナーを登録
eventBus.on('character:levelUp', (data) => {
  console.log(`${data.character.name} reached level ${data.newLevel}!`);
  showNotification(`レベルアップ！`);
});

eventBus.on('battle:end', (data) => {
  if (data.victory) {
    showVictoryScreen(data);
  } else {
    showGameOverScreen();
  }
});</code></pre>
                        </div>

                        <div class="cta" style="margin-top: 4rem;">
                            <h2>さらに詳しく</h2>
                            <p>より詳細なAPI仕様は、TypeScriptの型定義ファイルを参照してください</p>
                            <a href="https://github.com/yonyon-web/GEasy-Kit" class="btn btn-primary" target="_blank" rel="noopener">GitHubで見る</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 GEasy-Kit. Licensed under ISC.</p>
            <p>
                <a href="https://github.com/yonyon-web/GEasy-Kit" target="_blank" rel="noopener">GitHub</a> |
                <a href="https://github.com/yonyon-web/GEasy-Kit/issues" target="_blank" rel="noopener">Issues</a> |
                <a href="../docs/index.html">Docs</a>
            </p>
        </div>
    </footer>

    <script>
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    
                    // Update active state
                    document.querySelectorAll('.docs-sidebar a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });

        // Update active link on scroll
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.docs-content h1, .docs-content h2');
            const scrollPosition = window.scrollY + 100;

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionId = section.id;
                
                if (scrollPosition >= sectionTop) {
                    document.querySelectorAll('.docs-sidebar a').forEach(a => a.classList.remove('active'));
                    const activeLink = document.querySelector(`.docs-sidebar a[href="#${sectionId}"]`);
                    if (activeLink) activeLink.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
